## 一、变量提升

所谓的变量提升，是指在 JavaScript 代码执行过程中，JavaScript 引擎把变量的声明部分和函数的声明部分提升到代码开头的“行为”。变量被提升后，会给变量设置默认值——undefined。

**表象**：**函数和变量在执行之前都提升到了代码开头**。

**实际**：变量和函数声明在代码里的位置是不会改变的，而且是在**编译阶段被 JavaScript 引擎放入内存中**。



## 二、js代码执行流程

如下代码

```js
showName()
console.log(myname)
var myname = '极客时间'
function showName() {
  console.log('函数showName被执行');
}
```

### 1 编译阶段

生成：

- **执行上下文**（Execution context）
- 可执行代码 ——- 即字节码，不做介绍。

<img src="H:\前端\浏览器学习\imgs\0655d18ec347a95dfbf843969a921a13.png" style="zoom: 50%;" />

#### **a 执行上下文**

是 JavaScript 执行一段代码时的运行环境。包括：**变量环境**和**词法环境**

比如调用一个函数，就会进入这个函数的执行上下文，确定该函数在执行期间用到的诸如 this、变量、对象以及函数等

#### b 执行上下文 —— 变量环境及生成过程

保存了变量提升的内容

**过程**：

- 对该段js编译过程中，从头到尾（此法，语法分析），发现var和function 定义函数，就会在变量环境中创建对应属性
- 变量环境可以理解为一个对象——变量环境对象
- 对于var变量：引擎会在**变量环境对象**中创建名为myname的属性，值设为undefined
- 对于函数：
  - 引擎将函数showName定义**存储到堆** (HEAP）中，
  - 并在**变量环境对象**中，创建showName属性，指向堆中函数的位置



### 2 执行阶段

顺序执行

- 遇到变量（包括函数）, js引擎会在环境对象中查找，首先在词法环境对象中找，然后在变量环境对象中找
- 找打对应值，执行即可，没找到则会报引用错误



### 3 代码中出现相同变量或函数怎么办？

- 编译过程中遇到第二个相同变量name，无论是不处理还是对name重新赋值，值都为undefined
- 遇到第二个相同函数名称showName，
  - 该函数定义同样存入堆中，
  - 引擎将引用地址赋值给变量对象中的showName属性
  - 相当于showName指向最后一次定义的函数，相当于后面的函数覆盖了前面的函数













