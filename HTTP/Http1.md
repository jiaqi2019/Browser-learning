

# HTTP/1

## HTTP 1.0

随着网络的发展，浏览器中需要显示各种类型的文件，于是HTTP1.0引入的请求头和响应头。有哪些需求

- 浏览器需知道响应的**数据类型**， accept: text/html
- 文件越来越大，服务器压缩再发送，浏览器需要知道其**压缩方法**， accept-encoding: gzip, deflate, br
- 国际化的支持，浏览器需要告诉服务器所需的**语言**类型，accept-language: zh-CN,zh
- 不同类型文件的编码形式不一样，浏览器需要知道文件的二编码类型，accept-Charset: ISO-8859-1,utf-8

除了文件类型的支持，其他需求：

- 状态码：有的请求服务器可能无法处理，或者处理出错，就需要告诉浏览器服务器最终处理该请求的情况
- Cache机制：为了减轻服务器的压力
- 用户代理：服务器需要统计客户端的基础信息，



## HTTP1.1

对1.0进行改进

- **改进持久连接**
  - HTTP 的持久连接可以有效减少 TCP 建立连接和断开连接的次数，
  - 减少了服务器额外的负担，并提升整体 HTTP 的请求时长。
  - 目前浏览器中对于同一个域名，**默认允许同时建立 6 个 TCP 持久连接**。
- **不成熟的 HTTP 管线化**
  - 持久连接需要等待前面的请求返回之后，才能进行下一次请求，
  - 会有**队头阻塞**问题：TCP 通道中的某个请求因为某些原因没有及时返回。
  - HTTP/1.1 中试图通过管线化的技术来解决队头阻塞的，
  - 是指将多个 HTTP 请求整批提交给服务器的技术，虽然可以整批发送请求，不过服务器依然需要根据请求顺序来回复浏览器的请求。
  - 不过由于各种原因，管线化技术最终被各大厂商放弃了
- **提供虚拟主机的支持**
  - HTTP/1.0 中，每个域名绑定了一个唯一的 IP 地址，因此一个服务器只能支持一个域名。
  - 随着虚拟主机技术的发展，需要实现在一台物理主机上绑定多个虚拟主机，每个虚拟主机都有自己的单独的域名，这些单独的域名都公用同一个 IP 地址。
  - HTTP/1.1 的请求头中增加了 **Host 字段**，用来表示当前的域名地址，这样**服务器**就可以**根据**不同的 **Host** 值**做不同的处理**。
- **对动态生成的内容提供了完美支持**
  - HTTP/1.0 时，要在响应头中设置完整的数据大小，如Content-Length: 901，
  - 服务器端的技术发展，很多页面的内容都是动态生成的，因此在**传输数据之前**并**不知道**最终的**数据大小**，这就导致了浏览器不知道何时会接收完所有的文件数据。
  - HTTP/1.1 通过引入 **Chunk transfer** 机制来解决，**服务器会将数据分割成若干个任意大小的数据块，每个数据块发送时会附上上个数据块的长度，最后使用一个零长度的块作为发送数据完成的标志。**
- **客户端 Cookie、安全机制**
  - domain，path，secure，http-only，expires/max-age
  - 服务端（响应头）字段为set-cookie，浏览器端（请求头）为cookie

- **使用 CDN 的实现域名分片机制**











